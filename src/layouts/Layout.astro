---
import '../styles/global.css';

import { getSession } from 'auth-astro/server';

// Get session early in the component
const session = await getSession(Astro.request);

// If not in login page and no session, redirect to login
const isLoginPage = Astro.url.pathname === '/login';
if (!isLoginPage && !session) {
  return Astro.redirect('/login');
}

export interface Props {
  title: string;
}

const { title } = Astro.props;
---

<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <title>{title} - Google Photos Integration</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <script type="importmap">
      {
        "imports": {
          "@material/web/": "https://esm.run/@material/web/"
        }
      }
    </script>
    <script type="module">
      import '@material/web/all.js';
      import {styles as typescaleStyles} from '@material/web/typography/md-typescale-styles.js';

      document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
    </script>
  </head>
  <body class="min-h-screen bg-header flex flex-col items-center justify-center gap-5 p-5">
    <header class="flex flex-row items-center justify-start gap-1.5 w-full">
      <svg xmlns="http://www.w3.org/2000/svg" width="74" height="24" viewBox="0 0 74 24"><path d="M9.24 8.19v2.46h5.88c-.18 1.38-.64 2.39-1.34 3.1-.86.86-2.2 1.8-4.54 1.8-3.62 0-6.45-2.92-6.45-6.54s2.83-6.54 6.45-6.54c1.95 0 3.38.77 4.43 1.76L15.4 2.5C13.94 1.08 11.98 0 9.24 0 4.28 0 .11 4.04.11 9s4.17 9 9.13 9c2.68 0 4.7-.88 6.28-2.52 1.62-1.62 2.13-3.91 2.13-5.75 0-.57-.04-1.1-.13-1.54H9.24zm15.76-2c-3.21 0-5.83 2.44-5.83 5.81 0 3.34 2.62 5.81 5.83 5.81s5.83-2.46 5.83-5.81c0-3.37-2.62-5.81-5.83-5.81zm0 9.33c-1.76 0-3.28-1.45-3.28-3.52 0-2.09 1.52-3.52 3.28-3.52s3.28 1.43 3.28 3.52c0 2.07-1.52 3.52-3.28 3.52zm28.58-8.03h-.09c-.57-.68-1.67-1.3-3.06-1.3C47.53 6.19 45 8.72 45 12c0 3.26 2.53 5.81 5.43 5.81 1.39 0 2.49-.62 3.06-1.32h.09v.81c0 2.22-1.19 3.41-3.1 3.41-1.56 0-2.53-1.12-2.93-2.07l-2.22.92c.64 1.54 2.33 3.43 5.15 3.43 2.99 0 5.52-1.76 5.52-6.05V6.49h-2.42v1zm-2.93 8.03c-1.76 0-3.1-1.5-3.1-3.52 0-2.05 1.34-3.52 3.1-3.52 1.74 0 3.1 1.5 3.1 3.54.01 2.03-1.36 3.5-3.1 3.5zM38 6.19c-3.21 0-5.83 2.44-5.83 5.81 0 3.34 2.62 5.81 5.83 5.81s5.83-2.46 5.83-5.81c0-3.37-2.62-5.81-5.83-5.81zm0 9.33c-1.76 0-3.28-1.45-3.28-3.52 0-2.09 1.52-3.52 3.28-3.52s3.28 1.43 3.28 3.52c0 2.07-1.52 3.52-3.28 3.52zM58 .24h2.51v17.57H58zm10.26 15.28c-1.3 0-2.22-.59-2.82-1.76l7.77-3.21-.26-.66c-.48-1.3-1.96-3.7-4.97-3.7-2.99 0-5.48 2.35-5.48 5.81 0 3.26 2.46 5.81 5.76 5.81 2.66 0 4.2-1.63 4.84-2.57l-1.98-1.32c-.66.96-1.56 1.6-2.86 1.6zm-.18-7.15c1.03 0 1.91.53 2.2 1.28l-5.25 2.17c0-2.44 1.73-3.45 3.05-3.45z" fill="#fff"/></svg>
      <span class="text-xl font-medium text-secondary pb-1">Automover</span>
    </header>
    <main class="bg-background rounded-2xl p-5 flex flex-col justify-center gap-5">
      <slot />
    </main>
  </body>
</html>

<style is:global>
  @font-face {
      font-family: 'Product Sans';
      src: url('/fonts/ProductSans-Regular.woff2') format('woff2');
      font-weight: normal;
      font-style: normal;
      font-display: swap;
  }

  @font-face {
    font-family: 'Product Sans';
    src: url('/fonts/ProductSans-Black.woff2') format('woff2');
    font-weight: 900;
    font-style: normal;
    font-display: swap;
  }

  @font-face {
      font-family: 'Product Sans';
      src: url('/fonts/ProductSans-Bold.woff2') format('woff2');
      font-weight: bold;
      font-style: normal;
      font-display: swap;
  }

  @font-face {
      font-family: 'Product Sans';
      src: url('/fonts/ProductSans-Medium.woff2') format('woff2');
      font-weight: 400;
      font-style: normal;
      font-display: swap;
  }

  @font-face {
      font-family: 'Product Sans';
      src: url('/fonts/ProductSans-Light.woff2') format('woff2');
      font-weight: 300;
      font-style: normal;
      font-display: swap;
  }

  @font-face {
      font-family: 'Product Sans';
      src: url('/fonts/ProductSans-Thin.woff2') format('woff2');
      font-weight: 100;
      font-style: normal;
      font-display: swap;
  }

  :root {
    /* Checkbox */
    /* --md-sys-color-primary: #10547E;
    --md-sys-color-on-primary: #C4C7C5; */
    --md-sys-color-primary: #004A77;
    --md-sys-color-on-primary: #C2E7FF;

    /* List */
    --md-list-container-color: #1E1F20;
    --md-list-item-label-text-color: #C4C7C5;

    /* Button */
    --md-filled-tonal-button-container-color: #10547E;
    --md-filled-tonal-button-label-text-color: #C4C7C5;

    /* Input */
    --md-sys-color-primary: #10547E;
    --md-outlined-text-field-label-text-color: #1E1F20;
    --md-outlined-text-field-input-text-color: #C4C7C5;

    /* --md-icon-button-icon-size: 32px;
    --md-sys-color-on-surface-variant: #dc362e; */

    --md-filled-icon-button-selected-container-color: #004A77;
  }
</style>